var KonnektMP=function(){var r=function(r){return function(){function f(a){document.createDocumentFragment();this.name=a.tagName.toLowerCase();this.template=v[this.name]||'<div class="missing_component">Unknown Component</div>';this.node=a;this.fragment=document.createDocumentFragment();this.wrapper=this.fragment.appendChild(document.createElement("div"));this.wrapper.className="Wrapper Wrapper__"+this.name}function e(a,h,b,t){return{value:a,writable:!!h,enumerable:!!t,configurable:!!b}}function E(a,
h,b,t){Object.getOwnPropertyDescriptor(a,h);return{get:function(){return a.get(h)},set:function(h){(this._stopChange?a.stopChange():a).set(prop,h);this._stopChange=!1},configurable:!!b,enumerable:!!t}}function z(){return new RegExp("(\\"+k.split("").join("\\")+")(.*?)(\\"+q.split("").join("\\")+")","g")}function A(a){return a.split(new RegExp("("+k.split("").join("\\")+")(.*?)("+q.split("").join("\\")+")","g")).map(function(a,b,t){return t[b-1]===k?k+a+q:a}).filter(function(a,b,t){return 0!==a.length&&
a!==k&&a!==q&&0!==a.length})}function B(a){return a.replace(new RegExp("["+k+q+"]","g"),"").replace(new RegExp("\\"+u.split("").join("\\")+"(.*)"),"").replace(/\s/g,"")}function F(a){return a.reduce(function(a,b){b.match(/(\())(.*?)(\))/)?a.vmFilters[a.vmFilters.length]=b.replace(/[\(\)]/g,""):b.match(/(\[)(.*?)(\])/)?-1!==b.indexOf("~")?a.model[a.model.length]=b.replace(/[\[\]\~]/g,""):-1!==b.indexOf("+")?a.local[a.local.length]=b.replace(/[\[\]\+]/g,""):a.session[a.session.length]=b.replace(/[\[\]\-]/g,
""):a.filters[a.filters.length]=b;return a},{filters:[],vmFilters:[],model:[],local:[],session:[]})}function C(a){return-1!==a.indexOf("for")?a.replace(new RegExp("["+k+q+"]","g"),"").replace(/\|(.*)/,"").replace(/\s/g,"").split(/for(.*?)loop/).filter(function(a){return 0!==a.length}):[]}function D(){function a(a,d){this.text=a;this.key=d;var c;c=-1!==a.indexOf(u)?a.replace(new RegExp("["+q+"]","g"),"").replace(new RegExp("(.*?)(\\"+u.split("").join("\\")+")"),"").replace(/\s/g,"").split(","):[];
this.filters=F(c);this.component="for"===this.type?C(a)[1]:void 0;this.id=0}function h(a,d,c){return d.reduce(function(a,m){return c[m]?c[m](a):a},a)}function b(a,d){if(0!==d.length&&window.model)for(var c=0,b=d.length;c<b;c++)window.model.set(d[c],a)}function t(a,d){if(0!==a.length)for(var c=0,b=a.length;c<b;c++)localStorage.setItem(a[c],d)}function f(a,d){if(0!==filters.length)for(var c=0,b=filters.length;c<b;c++)sessionStorage.setItem(filters[c],d)}function k(a){for(var d=document.createElement(this.component),
c=0,b=Object.keys(this.value[a],"all"),h=b.length;c<h;c++)d.k_post||(d.k_post={},d.k_post.pointers={}),d.k_post.pointers[b[c]]=this.value[a];a>=this.node.children.length?this.node.appendChild(d):this.node.insertBefore(d,this.node.children[a])}function l(a){this.unsync();this.node.removeChild(this.node.children[a])}Object.defineProperties(a.prototype,{addPointer:e(k),removePointer:e(l),reapplyPointer:e(function(a){var b=this.node.children[a].kb_viewmodel,c=0;a=Object.keys(this.value[a],"all");for(var g=
a.length;c<g;c++)b.addPointer(this.value,a[c])}),mapDomPoint:e(function(){if(1===this.bindText.length){var a=this;this.node.addAttrUpdateListener(this.listener,function(b){a.setData(b.value)})}}),mapDataPoint:e(function(a){var b=this;this._data=a;Object.defineProperty(this,"value",E(a,this.key),!0,!0);"for"!==this.type?(this.dataListener=function(a){"delete"===a.event?b.unsync():b.setDom(a.value)},a.getLayer(this.key).addDataUpdateListener(this.key,this.dataListener)):(this.dataListener=function(a){b.setLoop(a.key,
a.event)},this.extraListener=function(a){b.setLoop("*","organize")},a.getLayer(this.key).addDataUpdateListener("*",this.dataListener).addMethodUpdateListener(this.extraListener))}),setData:e(function(a){a=h(a,this.filters.vmFilters,this._data.filters);this._data.set(this.key,a);b(this.filters.model,a);f(this.filters.session,a);t(this.filters.local,a)}),setDom:e(function(a){b(this.filters.model,a);f(this.filters.session,a);t(this.filters.local,a);this.local[this.attr]=h(a,this.filters.filters,this._data.filters)}),
setLoop:e(function(a,b){switch(b){case "create":k(a);break;case "delete":l(a);break;case "set":this.reapplyPointer(a);break;case "organize":for(var c=0,g=this.value.length;c<g;c++)this.reapplyPointer(c)}}),bindMaps:e([]),unsync:e(function(){Object.defineProperty(this,"value",e(void 0,!0,!0,!1));delete this.value;this.__proto__.bindText=null;this._data.getLayer(this.key).removeDataUpdateListener(this.dataListener);this.extraListener&&this._data.getLayer(this.key).removeMethodUpdateListener(this.extraListener);
this._data=null;delete this._data;this.bindMaps=null;delete this.bindMaps;this.binds=null;delete this.binds})});return a}var k="{{",q="}}",u="|",v={},G=/(<\/.*?>)/g;r().call();var H=Object.keys(HTMLElement.prototype).filter(function(a){return 0===a.indexOf("on")});f.start=function(a){if(void 0===a)return k;k="string"===typeof a?a:k;return f};f.end=function(a){if(void 0===a)return q;q="string"===typeof a?a:q;return f};f.pipe=function(a){if(void 0===a)return u;u="string"===typeof a?a:u;return f};f.getUnknown=
function(a){var h=a.match(G).map(function(a){return a.replace(/[<\/>]/g,"")});h.filter(function(a,f){return document.createElement(a)instanceof HTMLUnknownElement&&-1===h.indexOf(a,f+1)&&void 0===v[a]});return h};f.isRegistered=function(a){return void 0!==v[a]};f.register=function(a,h){void 0===v[a]?(v[a]=h,f.getUnknown(h)):console.error("Class: KonnektMP Method: 'register', A template by the name %o already exists",a);return this};Object.defineProperties(f.prototype,{register:e(f.register),isRegistered:e(f.isRegistered),
getUnknown:e(f.getUnknown),map:e(function(a){function h(b,f){for(var e=0,u=b.length;e<u;e++)if(void 0===b[e].kb_maps&&8!==b[e].nodeType){b[e].kb_mapper=a;b[e].kb_maps=f;if(3===b[e].nodeType){var l=b[e],m=f,d=l.textContent;if(d.match(z())){var c=A(d),g=D();g.prototype.type=d.match(new RegExp("(\\"+k.split("").join("\\")+")(.*?)(for)(.*?)(loop)(.*?)(\\"+q.split("").join("\\")+")","g"))?"for":"text";g.prototype.text=d;g.prototype.bindText=c;g.prototype.listener="textContent";g.prototype.attr="textContent";
g.prototype.local=l;g.prototype.node=l.parentElement;g.prototype.binds=m;l=0;for(d=c.length;l<d;l++)if(0===c[l].indexOf(k)){var w="for"===g.prototype.type?C(c[l])[0]:B(c[l]),n=new g(c[l],w);void 0===m[w]&&(m[w]=[]);n.bindText[l]=n;n.bindMaps.push(n);n.id=m[w].length;m[w].push(n)}}}else for(m=b[e],c=f,g=Array.prototype.slice.call(m.attributes),l=m instanceof HTMLUnknownElement,d=0,w=g.length;d<w;d++)if(g[d].value.match(z())){var n=A(g[d].value),p=D();p.prototype.type=l?"component":"attribute";p.prototype.text=
g[d].value;p.prototype.bindText=n;p.prototype.isEvent=-1!==H.indexOf(g[d].name);p.prototype.isInput="input"===m.tagName.toLowerCase();p.prototype.listener=g[d].name;p.prototype.attr=g[d].name;p.prototype.local=m;p.prototype.node=m.parentElement;p.prototype.binds=c;p.prototype.isEvent&&m.removeAttribute(g[d].name);for(var x=0,v=n.length;x<v;x++)if(0===n[x].indexOf(k)){var r=B(n[x]),y=new p(n[x],r);void 0===c[r]&&(c[r]=[]);y.bindText[x]=y;y.bindMaps.push(y);y.id=c[r].length;c[r].push(y)}}b[e].childNodes&&
0!==b[e].childNodes.length&&(f=h(b[e].childNodes,f))}return f}return h(a.childNodes,{})})});return f}}(Createkb);"undefined"!==typeof window&&"undefined"!==typeof window.define&&"undefined"!==typeof window.require?define([],function(){return r}):"undefined"!==typeof module&&(module.exports=r);return r}();
